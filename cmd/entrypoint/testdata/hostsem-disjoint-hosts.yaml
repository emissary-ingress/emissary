# This is actually nonsensical -- we till the system that we want ONLY CLEARTEXT,
# then we say we're configuring TLS termination, and that we want to redirect
# h2.example.com HTTP to HTTPS. So it won't actually function, but sure, you can 
# set things tup that way.
---
apiVersion: getambassador.io/v3alpha1
kind: Listener
metadata:
  name: listener-8888
spec:
  port: 8888
  protocol: HTTPS
  securityModel: XFP
  hostBinding:
    selector:
      matchLabels:
        listener-8888: "yes"
---
apiVersion: getambassador.io/v3alpha1
kind: Listener
metadata:
  name: listener-9999
spec:
  port: 9999
  protocol: HTTP
  securityModel: INSECURE
  hostBinding:
    selector:
      matchLabels:
        listener-9999: "yes"
---
apiVersion: getambassador.io/v2
kind: Host
metadata:
  name: h1-host
  labels:
    listener-8888: "yes"
    listener-9999: "yes"
spec:
  hostname: h1.example.com
  tlsSecret:
    name: h1-secret
  requestPolicy:
    insecure:
      action: Route
  selector:
    matchLabels:
      h1-host: "yes"
---
apiVersion: getambassador.io/v2
kind: Host
metadata:
  name: h2-host
  labels:
    listener-8888: "yes"
spec:
  hostname: h2.example.com
  tlsSecret:
    name: h2-secret
  requestPolicy:
    insecure:
      action: Redirect
  selector:
    matchLabels:
      h2-host: "yes"
---
apiVersion: getambassador.io/v2
kind: Host
metadata:
  name: h3-host
spec:
  hostname: h3.example.com
  tlsSecret:
    name: h2-secret
  requestPolicy:
    insecure:
      action: Reject
  selector:
    matchLabels:
      h3-host: "yes"
---
apiVersion: getambassador.io/v2
kind: Mapping
metadata:
  name: qotm-mapping
  labels:
    h1-host: "yes"
    h2-host: "yes"
    h3-host: "yes"
spec:
  prefix: /quote/
  service: quote.ambassador
---
apiVersion: getambassador.io/v2
kind: Mapping
metadata:
  name: mapping-to-ignore
  labels:
    ignore-this-mapping: "yes"
spec:
  prefix: /ignore-this-mapping/
  service: quote.ambassador
---
apiVersion: v1
kind: Secret
type: kubernetes.io/tls
metadata:
  name: h1-secret
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURGakNDQWY2Z0F3SUJBZ0lRRmp1dkpaYWVHanVGenhzMjh4bmdGVEFOQmdrcWhraUc5dzBCQVFzRkFEQXMKTVNvd0tBWURWUVFLRXlGQmJXSmhjM05oWkc5eUlFVmtaMlVnVTNSaFkyc2dVMlZzWmkxVGFXZHVaV1F3SGhjTgpNakV3TXpFMk1UTXpOVEEyV2hjTk1qSXdNekUyTVRNek5UQTJXakFzTVNvd0tBWURWUVFLRXlGQmJXSmhjM05oClpHOXlJRVZrWjJVZ1UzUmhZMnNnVTJWc1ppMVRhV2R1WldRd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFDbXdVOVM5bjN6NW9BV09USitSRDFIR3REV0xtR2VSVVhoRU4yVWRUbDdvWlVLb25iUApmVVFpUXMzLzduTkZXOGhTVWhoR2lwQW1CVzliQzhPUnFQWmNPczNkV25UWmdvVHBTVkk3Y01BL3duV1lTSWtJClQ2OTFPbzhhM2RaZFYzV1JpYWQ3RXMxWEY1QU0wN0JSR0p3WDY5dngzSEZ3aHFUR2k0MUFTUm9JdWp6ZDFPeDkKWGt6cllnTit6RWtxYXFIU05qWFluc1hhMW03QW9DNy9oaExrdmJEaUpmd2hGZTNoRXJHalNvZ3pGNHJmZ2lxZgpKOUFqMENWcGxhaDhLcGFFbC8yRVVFcEc0S291b1RsT2dhOGdud3ZnM21Bb2dUVklkcldrck9hdkN5c3BJcWswCkdWSGdQbnpWRkl2UFgwWkRTblhUbkduZERyVmFNSXVrODFoTkFnTUJBQUdqTkRBeU1BNEdBMVVkRHdFQi93UUUKQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBVEFMQmdOVkhSRUVCREFDZ2dBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBS0JwZVdkSGRhV2RubzEvUE1OZjc0ajVkejU5RFJjYUFuakxPd3AwYldZUnZXckVCQlcrClI4MldqZWZXOTczNXpMbWFMMmo4T3dMVkJTL29pQVVTZFpxRUcranV0aFlETTE0eHQzaWFCYnJ6SUd2SENIYjkKS2g2TnB6cHVzQ2o4ZWQ0SnphdlBPUkl6dW5OSWdlbzBqWGI4TUVDeXp6dFpoS0VZZXJNZ3ZMVVpXc09FZTNSUQp5d0Y4L3lrS29BWWlFcGc2cFp6ZmNxMWZHZmpHSlI1UjN5aFNYcEN1dGpsRmdQZjVCa3B2akMySk9Zalp2ZnY3Cmp3N0xZLzVpRmp6b1hOVTFIQ3R5RlZUTmFqTkEvL2xLVTZpc3d6MkNWZVNpUXVEZDFvV2twS0JxOXlwaHVTeGUKUXZINDk1OEU3YUxNY1NUZjlUbDZDMG9CS2FTOFJnWTNpTWs9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQ213VTlTOW4zejVvQVcKT1RKK1JEMUhHdERXTG1HZVJVWGhFTjJVZFRsN29aVUtvbmJQZlVRaVFzMy83bk5GVzhoU1VoaEdpcEFtQlc5YgpDOE9ScVBaY09zM2RXblRaZ29UcFNWSTdjTUEvd25XWVNJa0lUNjkxT284YTNkWmRWM1dSaWFkN0VzMVhGNUFNCjA3QlJHSndYNjl2eDNIRndocVRHaTQxQVNSb0l1anpkMU94OVhrenJZZ04rekVrcWFxSFNOalhZbnNYYTFtN0EKb0M3L2hoTGt2YkRpSmZ3aEZlM2hFckdqU29nekY0cmZnaXFmSjlBajBDVnBsYWg4S3BhRWwvMkVVRXBHNEtvdQpvVGxPZ2E4Z253dmczbUFvZ1RWSWRyV2tyT2F2Q3lzcElxazBHVkhnUG56VkZJdlBYMFpEU25YVG5HbmREclZhCk1JdWs4MWhOQWdNQkFBRUNnZ0VBRng1cDN2aXBrYXo5U1JkNDlxU0RVbDVYWWJwZ2NrN3NWejI5V3AyOThIUUEKYzg3K1pkbmFIbDNncllEam5sUVJPOGlCOFJXNDBteWllWjd4NkRuaW5mclJHOFUwdWdzc1hpTjZNUjk2cDl4UAo3V0x4REtQdmtYTWk3L2lkaGFkZ2QyTDhRMFhpRGhjSU01OE5yTkNhbzM1aHFmQ0VFYk81R0lXMGVac283dGlaCnk2dVQyUVdnaXgvdU1YR2hSbVlXUUh3MzNOSjlHMmtLbzlxcHFWRUg3UUZnT1VLNFZMV3l5U2V0Y2JiendyeEUKSCtQMlA0cEloL1NJQ1dxK2ViZ0k3b0lDTVBiOHpndFRvVkZwNFJvRk12Z05wV3czK0pManc1YlRSeXhZVjgwawpyenVmNmcydjFzZ2FnbEJ4a3FqeWtCNTZKOThIRGJWV2gxbHE2Qjhod1FLQmdRREY0MkhSLzcwenhBOExuZDF4Citzb2FmSFZObmwzUUovR1luVE9ieDRwS0xKdkMyRS8zeGJYcTN3TFJUaUJyay9XbG50SE5BT24xbFkwU3JmalAKU2FobHpLZjJVeVg2U08vV1lBVUovYWdjMFVMd3gwWUlvN0JRem1la1RlUTNOYU5rUGpTempTbnRSdENWV0l3NQpWcWNJMDdCdjhGQjRJS0tibm5OWENEZzhpUUtCZ1FEWHVYQmJHNWdtbWFWUXdzcGNrUk11OWgwV0xpRGwrdGxsCld4NDBqUERDdnI3R1dZdVc4TUpiZ3JKdUx3OTVDNHpFbnhMT1ZVQzV3TWRGZ1l5OE9GcklkSFdyN3V1WjFwcTcKcThHUldkNW93SG5sM1JRYXdDOWg5S2twWnBLYVNFaERjUWpyU3UwVjY4Skg0K2lnMHV3TVJMQ09NSk43dDYyRQpSY3lVL0FTMHBRS0JnR3FoVmFxRXRYelpYb29SN0t0b1NkTHYwWDJib2sxeDJKczF5Z05kQ0VWanVDTEwwSHRnCmkrQWRmelV0ZGdiQjJaSCsvR29NM2dTNUt5VXZuV3lFOGpxNGhxRVN1Tm9leHkycTI4eEFaSC95dXJGbmozTkUKVU5PYUJQcmlCZUZDQStNV0tldStXeU5DRDA4S1FiVDczbEhCVDhkaHBOcTJLeWpUdnE3Yy9RQ1JBb0dCQUllMgpERjMwblNKamRHRzdPVzFFZ3luL0FNdHNWNXYyMUg3ejlLdWdvdklRNTVtR3ljODZSVHNtbkxPK2ZXQnNDTEhGClZTSmk5YVltQmZiUENrZDZ1SG4wOGZZcEJ5U3Zvb1pBQmpVM3NUaDdKZlNhd1VRVzlYZ05YOEpBMmllZkkzN3kKQkdkcHFuOG80djh3L0s3NElqR1JvUFRDMEhWN1Z2aW9wSXh4ZzFCVkFvR0JBSzFxbkFQbjhaaXl4aUxtRm1hMApBeFpkV25Fa2NHSVFuMEdqQnNZUkhYRnlvQ3N5UXhLMVR0TnkwcTljem1qZ00zQUVpekZuREZ6SnBzZEpHZHk5ClpFREkzWkpiamhvMlo2R29URGhLcWVoTjFQcERpREt5ait4L0xYN1dPdTBqN3p5YzBwekJ2K2twdHo3aFhReksKMzBiM3puWGtwaGhiQXVwdGFzOXBkc3NJCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
---
apiVersion: v1
kind: Secret
type: kubernetes.io/tls
metadata:
  name: h2-secret
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURGakNDQWY2Z0F3SUJBZ0lRRmp1dkpaYWVHanVGenhzMjh4bmdGVEFOQmdrcWhraUc5dzBCQVFzRkFEQXMKTVNvd0tBWURWUVFLRXlGQmJXSmhjM05oWkc5eUlFVmtaMlVnVTNSaFkyc2dVMlZzWmkxVGFXZHVaV1F3SGhjTgpNakV3TXpFMk1UTXpOVEEyV2hjTk1qSXdNekUyTVRNek5UQTJXakFzTVNvd0tBWURWUVFLRXlGQmJXSmhjM05oClpHOXlJRVZrWjJVZ1UzUmhZMnNnVTJWc1ppMVRhV2R1WldRd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFDbXdVOVM5bjN6NW9BV09USitSRDFIR3REV0xtR2VSVVhoRU4yVWRUbDdvWlVLb25iUApmVVFpUXMzLzduTkZXOGhTVWhoR2lwQW1CVzliQzhPUnFQWmNPczNkV25UWmdvVHBTVkk3Y01BL3duV1lTSWtJClQ2OTFPbzhhM2RaZFYzV1JpYWQ3RXMxWEY1QU0wN0JSR0p3WDY5dngzSEZ3aHFUR2k0MUFTUm9JdWp6ZDFPeDkKWGt6cllnTit6RWtxYXFIU05qWFluc1hhMW03QW9DNy9oaExrdmJEaUpmd2hGZTNoRXJHalNvZ3pGNHJmZ2lxZgpKOUFqMENWcGxhaDhLcGFFbC8yRVVFcEc0S291b1RsT2dhOGdud3ZnM21Bb2dUVklkcldrck9hdkN5c3BJcWswCkdWSGdQbnpWRkl2UFgwWkRTblhUbkduZERyVmFNSXVrODFoTkFnTUJBQUdqTkRBeU1BNEdBMVVkRHdFQi93UUUKQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBVEFMQmdOVkhSRUVCREFDZ2dBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBS0JwZVdkSGRhV2RubzEvUE1OZjc0ajVkejU5RFJjYUFuakxPd3AwYldZUnZXckVCQlcrClI4MldqZWZXOTczNXpMbWFMMmo4T3dMVkJTL29pQVVTZFpxRUcranV0aFlETTE0eHQzaWFCYnJ6SUd2SENIYjkKS2g2TnB6cHVzQ2o4ZWQ0SnphdlBPUkl6dW5OSWdlbzBqWGI4TUVDeXp6dFpoS0VZZXJNZ3ZMVVpXc09FZTNSUQp5d0Y4L3lrS29BWWlFcGc2cFp6ZmNxMWZHZmpHSlI1UjN5aFNYcEN1dGpsRmdQZjVCa3B2akMySk9Zalp2ZnY3Cmp3N0xZLzVpRmp6b1hOVTFIQ3R5RlZUTmFqTkEvL2xLVTZpc3d6MkNWZVNpUXVEZDFvV2twS0JxOXlwaHVTeGUKUXZINDk1OEU3YUxNY1NUZjlUbDZDMG9CS2FTOFJnWTNpTWs9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRQ213VTlTOW4zejVvQVcKT1RKK1JEMUhHdERXTG1HZVJVWGhFTjJVZFRsN29aVUtvbmJQZlVRaVFzMy83bk5GVzhoU1VoaEdpcEFtQlc5YgpDOE9ScVBaY09zM2RXblRaZ29UcFNWSTdjTUEvd25XWVNJa0lUNjkxT284YTNkWmRWM1dSaWFkN0VzMVhGNUFNCjA3QlJHSndYNjl2eDNIRndocVRHaTQxQVNSb0l1anpkMU94OVhrenJZZ04rekVrcWFxSFNOalhZbnNYYTFtN0EKb0M3L2hoTGt2YkRpSmZ3aEZlM2hFckdqU29nekY0cmZnaXFmSjlBajBDVnBsYWg4S3BhRWwvMkVVRXBHNEtvdQpvVGxPZ2E4Z253dmczbUFvZ1RWSWRyV2tyT2F2Q3lzcElxazBHVkhnUG56VkZJdlBYMFpEU25YVG5HbmREclZhCk1JdWs4MWhOQWdNQkFBRUNnZ0VBRng1cDN2aXBrYXo5U1JkNDlxU0RVbDVYWWJwZ2NrN3NWejI5V3AyOThIUUEKYzg3K1pkbmFIbDNncllEam5sUVJPOGlCOFJXNDBteWllWjd4NkRuaW5mclJHOFUwdWdzc1hpTjZNUjk2cDl4UAo3V0x4REtQdmtYTWk3L2lkaGFkZ2QyTDhRMFhpRGhjSU01OE5yTkNhbzM1aHFmQ0VFYk81R0lXMGVac283dGlaCnk2dVQyUVdnaXgvdU1YR2hSbVlXUUh3MzNOSjlHMmtLbzlxcHFWRUg3UUZnT1VLNFZMV3l5U2V0Y2JiendyeEUKSCtQMlA0cEloL1NJQ1dxK2ViZ0k3b0lDTVBiOHpndFRvVkZwNFJvRk12Z05wV3czK0pManc1YlRSeXhZVjgwawpyenVmNmcydjFzZ2FnbEJ4a3FqeWtCNTZKOThIRGJWV2gxbHE2Qjhod1FLQmdRREY0MkhSLzcwenhBOExuZDF4Citzb2FmSFZObmwzUUovR1luVE9ieDRwS0xKdkMyRS8zeGJYcTN3TFJUaUJyay9XbG50SE5BT24xbFkwU3JmalAKU2FobHpLZjJVeVg2U08vV1lBVUovYWdjMFVMd3gwWUlvN0JRem1la1RlUTNOYU5rUGpTempTbnRSdENWV0l3NQpWcWNJMDdCdjhGQjRJS0tibm5OWENEZzhpUUtCZ1FEWHVYQmJHNWdtbWFWUXdzcGNrUk11OWgwV0xpRGwrdGxsCld4NDBqUERDdnI3R1dZdVc4TUpiZ3JKdUx3OTVDNHpFbnhMT1ZVQzV3TWRGZ1l5OE9GcklkSFdyN3V1WjFwcTcKcThHUldkNW93SG5sM1JRYXdDOWg5S2twWnBLYVNFaERjUWpyU3UwVjY4Skg0K2lnMHV3TVJMQ09NSk43dDYyRQpSY3lVL0FTMHBRS0JnR3FoVmFxRXRYelpYb29SN0t0b1NkTHYwWDJib2sxeDJKczF5Z05kQ0VWanVDTEwwSHRnCmkrQWRmelV0ZGdiQjJaSCsvR29NM2dTNUt5VXZuV3lFOGpxNGhxRVN1Tm9leHkycTI4eEFaSC95dXJGbmozTkUKVU5PYUJQcmlCZUZDQStNV0tldStXeU5DRDA4S1FiVDczbEhCVDhkaHBOcTJLeWpUdnE3Yy9RQ1JBb0dCQUllMgpERjMwblNKamRHRzdPVzFFZ3luL0FNdHNWNXYyMUg3ejlLdWdvdklRNTVtR3ljODZSVHNtbkxPK2ZXQnNDTEhGClZTSmk5YVltQmZiUENrZDZ1SG4wOGZZcEJ5U3Zvb1pBQmpVM3NUaDdKZlNhd1VRVzlYZ05YOEpBMmllZkkzN3kKQkdkcHFuOG80djh3L0s3NElqR1JvUFRDMEhWN1Z2aW9wSXh4ZzFCVkFvR0JBSzFxbkFQbjhaaXl4aUxtRm1hMApBeFpkV25Fa2NHSVFuMEdqQnNZUkhYRnlvQ3N5UXhLMVR0TnkwcTljem1qZ00zQUVpekZuREZ6SnBzZEpHZHk5ClpFREkzWkpiamhvMlo2R29URGhLcWVoTjFQcERpREt5ait4L0xYN1dPdTBqN3p5YzBwekJ2K2twdHo3aFhReksKMzBiM3puWGtwaGhiQXVwdGFzOXBkc3NJCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
