---
apiVersion: v1
kind: Service
metadata:
  name: load-minute
  namespace: default
  annotations:
    getambassador.io/config: |
      ---
      apiVersion: ambassador/v1
      kind: Mapping
      ambassador_id:
      - ambassador-pro
      - ambassador-pro-rlonly
      name: load_testing_rl_minute
      prefix: /load-testing/rl-minute/
      service: load-http-echo
      labels:
        ambassador:
          - request_label_group:
            - minute
spec:
  selector:
    app: load-http-echo
  ports:
  - port: 80
    name: http
    targetPort: http-api
---
apiVersion: getambassador.io/v1beta2
kind: RateLimit
metadata:
  name: load-rl-minute
  namespace: default
spec:
  domain: ambassador
  limits:
   - pattern: [{generic_key: minute}]
     rate: 30000
     unit: minute
