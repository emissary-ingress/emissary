---
apiVersion: v1
kind: Service
metadata:
  name: load-second
  namespace: default
  annotations:
    getambassador.io/config: |
      ---
      apiVersion: ambassador/v1
      kind: Mapping
      ambassador_id: ambassador-pro
      name: load_testing_rl_second
      prefix: /load-testing/rl-second/
      service: load-http-echo
      labels:
        ambassador:
          - request_label_group:
            - second
spec:
  selector:
    app: load-http-echo
  ports:
  - port: 80
    name: http
    targetPort: http-api
---
apiVersion: getambassador.io/v1beta2
kind: RateLimit
metadata:
  name: load-rl-second
  namespace: default
spec:
  domain: ambassador
  limits:
   - pattern: [{generic_key: second}]
     rate: 500
     unit: second
