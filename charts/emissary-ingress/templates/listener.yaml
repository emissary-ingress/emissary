{{- range $name, $listener := .Values.listeners }}
{{- if or $listener.create (and $.Values.createDefaultListeners (has $name (list "http" "https"))) }}
---
apiVersion: getambassador.io/v3alpha1
kind: Listener
metadata:
  name: {{ include "ambassador.fullname" $ }}-{{ $name }}-listener
  namespace: {{ include "ambassador.namespace" $ }}
spec:
  {{- if hasKey $.Values.env "AMBASSADOR_ID" }}
  ambassador_id:
  - {{ $.Values.env.AMBASSADOR_ID | quote }}
  {{- end }}
  {{- toYaml $listener.spec | nindent 2 }}
{{- end }}
{{- end }}
